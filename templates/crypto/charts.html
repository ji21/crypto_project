{% extends "base.html" %}
{% load static %}

{% block title %}Charts{% endblock %}
{% block stylesheet %} <link rel="stylesheet" type="text/css" href="{% static 'css/charts.css' %}">{% endblock %}

{% block content %}
  <div id="content" class="adjusted-width">
    <h3 class="ml-3" style="margin-top: 6rem;">Bitcoin Market Price</h3>
    <div class="market_price_div mt-3 mb-3 ml-3 mr-4 pr-4 round">
      <canvas id="myChart" class="p-3"></canvas>
    </div>
    <div class="ml-3 d-flex mr-4 mt-5 row-rapper">
      <div class="current-price mr-3">
        <h3 class="" style="">Current Price</h3>
        <div class="round mt-4 d-flex flex-column align-items-center">
          <div class="mb-4 mt-4" style="color: rgba(10, 10, 10, 0.6)" id="price-text"></div>
          <div class="d-flex align-items-center">
            <div class="mr-2" id="difference" style="font-size: 30px; color: #3BE2AB; font-weight: 500">+13%</div>
            <i class="fas pt-3 mb-3" id="thumb" style="font-size: 60px; color: #3BE2AB"></i>
          </div>
          <div class="mt-4" id="price-statement" style="color: rgba(10, 10, 10, 0.6); text-align: center">A 13% increase in market price.</div>
        </div>
      </div>
      <div class="transaction {% if not request.user.is_authenticated %}disable{% endif %}">
        <h3 class="">Make a Transaction</h3>
        {% if request.user.is_authenticated %}
          {% csrf_token %}
          <div class="round mt-4 d-flex align-items-center">
            <div id="this-div" class="h-100">
              <div class="mt-4 ml-4 mr-1" id="divy" style="color: rgba(10, 10, 10, 0.6)">Buy and sell bitcoins using virtual money in your virtual accounts. Transactions on bytimise is non-official and will not contribute in affecting the live market price.</div>
              <a class="btn d-inline-block btn-secondary dropdown-toggle pb-3 mt-2" style="height: 40px; margin-left: auto; margin-right: 0" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Select an account
              </a>
              <div class="ml-3 mt-2" id="balance" style="color: rgba(10, 10, 10, 0.6); width: 265px;">Don't have a virtual account?<a href="{% url 'accounts' %}" style="display: block">Create one.</a></div>

              <div class="dropdown-menu" aria-labelledby="dropdownMenuLink" style="overflow: scroll; height: 170px">
                {% for account in accounts %}
                <a class="dropdown-item" href="#" id="{{account.id}}">{{account.name}}</a>
                {% endfor %}
              </div>
            </div>
            <div id="trans-div" style="border-left: 2px solid rgba(240, 243, 248); width: 80%; height: 85%; display: none"></div>
          </div>
        {% else %}
          <div class="round mt-4">
            <p style="margin: 7rem auto; width: 60%; text-align: center" class="enable">Please log in to start trading with virtual money.</p>
          </div>
        {% endif %}
      </div>
    </div>
    <div class="ml-3 mr-4 mt-5 row-rapper">
      <h3>Historical Data</h3>
      <div id="pad-change" class="his-chart pt-4 pb-5 pl-0 pr-0 round d-flex align-items-center mt-4">
        <div style="height: 100%" class="w-75">
          <ul class="nav nav-pills mb-0" style="margin-left: 6rem;" id="pills-tab" role="tablist">
            <li class="nav-item">
              <a class="nav-link active" style="text-align:center" id="pills-week-tab" data-toggle="pill" href="#pills-home" role="tab" aria-controls="pills-home" aria-selected="true">Week</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" style="text-align:center" id="pills-month-tab" data-toggle="pill" href="#pills-profile" role="tab" aria-controls="pills-profile" aria-selected="false">Month</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" style="text-align:center" id="pills-max-tab" data-toggle="pill" href="#pills-contact" role="tab" aria-controls="pills-contact" aria-selected="false">All Time Price</a>
            </li>
          </ul>
          <canvas id="historicalChart" class="p-3"></canvas>
        </div>
        <div style="height:100%; width: 20%; text-align: center; color: rgba(10, 10, 10, 0.6); font-size: 30px" class="ml-3 pt-4 mt-5">
          <div id="all-time-high">
            All time high: 10000.00 USD
          </div>
          <div style="font-size: 16px" class="mt-4">
            (datapoints are calculated using bpi, british price index for whatever reason because ive no idea what im typing and this is just a filler text)
          </div>
        </div>
      </div>
    </div>
    <div style="height: 40px"></div>
  </div>
{% endblock %}


{% block scripts %}
  <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
  <script src="{% static 'js/socket.js' %}"></script>
{% endblock %}
